# LAMDiceBot 팀 회의록 (Single)

**일시**: 2026-02-03 14:00
**주제**: 경마 게임 밸런스 - 부스터 연속 발동 및 역전 가능성 개선
**참석자 (관점)**:
- 기획팀: 기획 팀장, 기획 사원
- 개발팀: 개발 팀장, 개발 사원
- 디자인팀: UI/UX 디자이너, 사운드 디자이너
- 품질팀: QA 엔지니어
**회의 방식**: 1인 순차 분석 (경량 버전)
**게임 대상**: 경마 게임 (horse-race)

---

## 1. 현황 요약

### 현재 기믹 시스템 분석 (`config/horse/race.json`)

| 카테고리 | 기믹 종류 | 확률 | 지속시간 | 속도배율 |
|----------|-----------|------|----------|----------|
| **boost** | sprint | 15% | 300-700ms | 1.2-1.5x |
| **boost** | item_boost | 10% | 2000-3000ms | 1.3-1.6x |
| **stop** | stop | 15% | 300-800ms | 0x |
| **stop** | obstacle | 12% | 500-1500ms | 0x |
| **stop** | item_trap | 10% | 1000-2000ms | 0.1x |
| **slow** | slow | 13% | 400-1000ms | 0.2-0.5x |
| **slow** | wobble | 7% | 500-1000ms | 0.7-1.0x |
| **reverse** | slip | 10% | 200-500ms | -0.3~-0.7x |
| **reverse** | reverse | 8% | 1000-2000ms | -1.5~-2.0x → 체인부스트 |

### 카테고리별 총 확률
- **boost (가속)**: 25% (sprint 15% + item_boost 10%)
- **stop (정지)**: 37% (stop 15% + obstacle 12% + item_trap 10%)
- **slow (감속)**: 20% (slow 13% + wobble 7%)
- **reverse (역주행)**: 18% (slip 10% + reverse 8%)

### 현재 연속 방지 로직 (`socket/horse.js:156-168`)
```javascript
// 같은 category 연속 방지 (최대 3회 재뽑기)
let lastCategory = null;
for (let attempt = 0; attempt < 3; attempt++) {
    // ... 뽑기 ...
    if (tc.category !== lastCategory) break;
}
lastCategory = tc.category || null;
```

**문제점**: 직전 기믹만 체크하므로 A-B-A-B 패턴 방지 불가

### 트랙별 기믹 개수
- Short: 3-5개
- Medium: 3-5개
- Long: 5-8개

---

## 2. 관점별 분석 결과

### 기획팀

#### 2-1. 기획 팀장 (A1) - 전략적 제안

**문제 진단**:
> "역전이 어렵다"는 것은 게임의 **드라마틱한 전개가 부족**하다는 의미입니다. 꼴등 맞추기 게임에서 역전 가능성은 핵심 재미 요소입니다.

**제안 1: 러버밴딩(Rubber-banding) 시스템 도입** ⭐
- 현재 순위에 따라 기믹 확률 보정
- 1등: 감속/정지 기믹 확률 +20%
- 꼴등: 가속 기믹 확률 +20%
- 비즈니스 가치: 게임 결과 예측 불가능성 증가 → 재플레이율 상승

**제안 2: 부스터 글로벌 쿨다운 도입**
- 한 말에 부스터가 발동하면 2-3초간 해당 말은 부스터 재발동 불가
- 우선순위: **높음** (핵심 불만 사항 해결)

**제안 3: 역전 이벤트 확률 조정**
- item_boost 확률 10% → 7% 감소
- 대신 "순위 뒤집기" 신규 기믹 추가 (1등과 꼴등 위치 교환)

---

#### 2-2. 기획 사원 (A2) - 사용자 중심 제안

**유저 입장 분석**:
> "내 말이 계속 부스터 받는 상대한테 추월당해서 답이 없어요"

**제안 1: 시각적 역전 희망 제공**
- 꼴등 근처 말에게 "반격 찬스!" 이펙트 표시
- 플레이어가 "아직 기회가 있다"고 느끼게 함

**제안 2: 부스터 지속시간 조정**
- item_boost 2000-3000ms → **1000-1500ms로 축소**
- 너무 긴 부스터가 역전 불가능 인식의 주원인

**제안 3: 기믹 발동 시점 분산**
- 현재: 10%-85% 구간에서 랜덤
- 개선: 레이스 후반부(60%-90%)에 역전 기믹 집중 배치
- 시나리오: "막판 역전 드라마" 연출 가능

---

### 개발팀

#### 2-3. 개발 팀장 (B1) - 아키텍처 제안

**기술 분석**:
현재 기믹 시스템은 `race.json` 설정 기반으로 잘 분리되어 있어 확장에 용이함.

**제안 1: 기믹 쿨다운 시스템 아키텍처**
```javascript
// horse.js에 추가할 구조
const gimmickCooldowns = {
    boost: { lastTriggerTime: 0, cooldownMs: 3000 },
    // 카테고리별 쿨다운 관리
};
```
- 영향 범위: `socket/horse.js` 기믹 생성 로직
- 확장성: 설정 파일로 분리 가능

**제안 2: 순위 기반 확률 보정 시스템**
- 시뮬레이션 루프에서 현재 순위 추적 필요
- 기술 부채 우려: 시뮬레이션 복잡도 증가
- 대안: 기믹 생성 시점에 "뒤처진 말 우선" 로직 적용

**제안 3: 기믹 히스토리 기반 중복 방지**
- 최근 N개 기믹 카테고리 추적하여 패턴 방지
- 메모리 오버헤드: 미미함 (말당 배열 5개 정도)

---

#### 2-4. 개발 사원 (B2) - 구현 중심 제안

**빠른 구현 가능한 수정**:

**제안 1: 연속 방지 로직 강화** (즉시 적용 가능) ⭐
```javascript
// socket/horse.js:156-168 수정
let lastTwoCategories = [null, null]; // 최근 2개 추적
for (let i = 0; i < gimmickCount; i++) {
    for (let attempt = 0; attempt < 5; attempt++) { // 재뽑기 5회로 증가
        // ... 뽑기 ...
        // 최근 2개와 모두 다른 경우에만 break
        if (!lastTwoCategories.includes(tc.category)) break;
    }
    lastTwoCategories.shift();
    lastTwoCategories.push(tc.category);
}
```
- 영향 파일: `socket/horse.js`
- 구현 시간: 30분

**제안 2: item_boost 너프** (설정 파일 수정)
```json
// race.json 수정
"item_boost": {
    "probability": 0.07,  // 10% → 7%
    "durationRange": [1200, 1800],  // 2000-3000 → 1200-1800
    "speedMultiplierRange": [1.2, 1.4]  // 1.3-1.6 → 1.2-1.4
}
```
- 영향 파일: `config/horse/race.json`
- 구현 시간: 5분

**제안 3: 새로운 역전 기믹 추가**
```json
"catch_up": {
    "category": "boost",
    "probability": 0.08,
    "durationRange": [1500, 2500],
    "speedMultiplierRange": [1.4, 1.8],
    "condition": "rank >= totalHorses * 0.7"  // 하위 30%에서만 발동
}
```
- 주의: 조건부 기믹은 시뮬레이션 로직 수정 필요

---

### 디자인팀

#### 2-5. UI/UX 디자이너 (C)

**사용자 경험 분석**:
> 역전이 힘들다는 인식 = 시각적 피드백 부족 + 실제 밸런스 문제

**제안 1: 부스터 게이지 시각화**
- 부스터 지속시간을 말 위에 게이지바로 표시
- "곧 부스터가 끝난다"는 정보 제공 → 희망 유지

**제안 2: 역전 가능성 인디케이터**
- 꼴등 말에게 "기회!" 아이콘 표시 (조건: 앞 말과 거리 < 20m)
- 시각적 긴장감 유지

**제안 3: 레이스 후반 연출 강화**
- 80% 진행 시점부터 슬로모션 빈도 증가
- 접전 상황 강조 → 드라마틱한 결말 연출

---

#### 2-6. 사운드 디자이너 (D)

**현재 사운드 현황** (`assets/sounds/horse-race/`):
- start.mp3, countdown.mp3, running-loop.mp3, finish.mp3 등 기본 제공

**제안 1: 역전 상황 전용 사운드**
- "comeback.mp3": 꼴등이 순위 상승 시 재생
- 긴장감 있는 드럼롤 또는 고조되는 BGM

**제안 2: 부스터 연속 발동 경고음**
- 같은 말이 2연속 부스터 시 특별한 사운드
- 플레이어가 "저 말 부스터 많이 받네" 인지 가능

**제안 3: 막판 추월 사운드**
- 마지막 10% 구간에서 순위 변동 시
- 관중 환호 또는 긴박한 효과음

---

### 품질팀

#### 2-7. QA 엔지니어 (E) - 테스트 방법론

**밸런스 검증 방법론**:

**테스트 1: 부스터 연속 발동 빈도 측정**
```
방법: 1000회 자동 레이스 시뮬레이션
측정: 말당 부스터 연속 발동 횟수 통계
기준: 3연속 이상 발생률 < 5%
도구: AutoTest/horse-race/ 확장
```

**테스트 2: 역전 성공률 측정**
```
방법: 레이스 50% 시점 순위 vs 최종 순위 비교
측정: 순위 변동 발생률
기준: 최소 30% 레이스에서 1회 이상 역전 발생
```

**테스트 3: 수정 전후 A/B 비교**
```
그룹 A: 현재 설정
그룹 B: 수정된 설정
비교: 역전 발생률, 게임 시간, 결과 분포
```

---

## 3. 테스트 전략 (QA 주도)

| 기능 | 테스트 방법 | 자동화 가능 | 검증 기준 |
|------|-------------|-------------|-----------|
| 부스터 연속 방지 | 1000회 시뮬레이션 | O | 동일 카테고리 3연속 < 5% |
| item_boost 너프 | 100회 레이스 실행 | O | 평균 부스터 시간 1500ms 이하 |
| 역전 발생률 | 500회 레이스 통계 | O | 후반 역전 > 25% |
| 러버밴딩 효과 | 순위별 기믹 분포 분석 | O | 꼴등 가속 확률 > 평균 |

---

## 4. 합의 도출

| 우선순위 | 기능 | 판정 | 주요 지지 관점 | 근거 |
|---------|------|------|---------------|------|
| 1 | **연속 방지 로직 강화** (최근 2개 카테고리 체크) | **채택** | 개발 B2, 기획 A1 | 즉시 구현 가능, 핵심 불만 해결 |
| 2 | **item_boost 너프** (지속시간/배율 감소) | **채택** | 기획 A2, 개발 B2 | 설정 파일만 수정, 리스크 낮음 |
| 3 | 부스터 쿨다운 시스템 | **보류** | 기획 A1, 개발 B1 | 아키텍처 변경 필요, 추후 검토 |
| 4 | 러버밴딩 시스템 | **보류** | 기획 A1 | 시뮬레이션 복잡도 증가, 장기 과제 |
| 5 | 역전 전용 기믹 추가 | **검토** | 기획 A2 | 조건부 기믹 로직 필요, 중기 과제 |

### 관점 간 충돌 사항

1. **기획 A1 (러버밴딩) vs 개발 B1 (복잡도 우려)**
   - 러버밴딩은 효과적이나 시뮬레이션 복잡도 증가
   - **합의**: 1차로 간단한 수정 적용 후, 효과 부족 시 2차로 러버밴딩 검토

2. **기획 A2 (신규 기믹) vs QA E (테스트 부담)**
   - 신규 기믹은 테스트 케이스 증가
   - **합의**: 기존 기믹 수치 조정 우선, 신규는 충분한 테스트 후 적용

---

## 5. 다음 단계 (Action Items)

### 즉시 적용 (1차 밸런스 패치)
- [ ] `socket/horse.js`: 연속 방지 로직 강화 (최근 2개 카테고리 체크, 재뽑기 5회)
- [ ] `config/horse/race.json`: item_boost 너프
  - probability: 10% → 7%
  - durationRange: [2000,3000] → [1200,1800]
  - speedMultiplierRange: [1.3,1.6] → [1.2,1.4]

### 효과 측정
- [ ] 100회 테스트 레이스 후 역전 발생률 비교
- [ ] 부스터 연속 발동 통계 수집

### 2차 검토 (효과 부족 시)
- [ ] 부스터 글로벌 쿨다운 시스템 설계
- [ ] 러버밴딩 시스템 프로토타입

---

---

## 6. 추가 검토 (3회차 심층 분석)

### 검토 #1: 문서-설정 불일치 발견 ⚠️

| 항목 | 문서 (`HORSE_GIMMICK_ANALYSIS.md`) | 실제 설정 (`race.json`) | 차이 |
|------|-----------------------------------|------------------------|------|
| SPRINT 속도 | 1.8-3.0x | **1.2-1.5x** | 문서 과장 |
| ITEM_BOOST 속도 | 2.5-4.0x | **1.3-1.6x** | 문서 과장 |
| OBSTACLE 지속시간 | 1000-3000ms | **500-1500ms** | 문서 과장 |

**결론**: 실제 설정값은 문서보다 보수적임. **문서 업데이트 필요**.

---

### 검토 #2: 기믹 동시 활성화 문제 발견 ⚠️

**현재 로직** (`socket/horse.js:960-966`):
```javascript
let speedMultiplier = 1;
gimmicks.forEach(gimmick => {
    if (gimmick.active) {
        hasActiveGimmick = true;
        speedMultiplier = gimmick.speedMultiplier; // 마지막 값으로 덮어씀!
    }
});
```

**문제점**:
- 여러 기믹이 동시에 활성화되면 **마지막 기믹만 적용**
- 기믹 간 **상호작용 없음** (boost + slow 동시 → 하나만 적용)
- progressTrigger가 순수 랜덤이라 **기믹 클러스터링** 가능

**예시 시나리오**:
```
기믹 A: progressTrigger=0.45, type=slow (0.3x)
기믹 B: progressTrigger=0.46, type=sprint (1.5x)
→ 둘 다 거의 동시 발동 → sprint만 적용 (slow 무시)
```

**개선안**: 기믹 간 최소 간격 보장 (예: 10% progress 이상 간격)

---

### 검토 #3: 구조적 문제점 종합

| 문제 | 현황 | 영향 | 해결책 |
|------|------|------|--------|
| **기믹 간격 미보장** | progressTrigger 순수 랜덤 | 클러스터링 발생 | 최소 간격 강제 |
| **마지막 기믹 우선** | 동시 활성 시 덮어쓰기 | 기믹 효과 손실 | 우선순위/합산 로직 |
| **말 간 불균형** | 각 말 독립 기믹 생성 | 운에 따른 결과 편차 | 기믹 총량 밸런싱 |
| **연속 방지 허점** | A-B-A-B 패턴 미차단 | 부스터 체감 연속 | 최근 N개 체크 |

---

### 최종 개선안 (우선순위 재조정)

| 순위 | 개선안 | 난이도 | 효과 | 즉시적용 |
|------|--------|--------|------|----------|
| **1** | 연속 방지 강화 (최근 2개 체크) | 낮음 | 높음 | ✅ |
| **2** | item_boost 너프 | 낮음 | 중간 | ✅ |
| **3** | 기믹 간 최소 간격 보장 (10%) | 낮음 | 중간 | ✅ |
| **4** | 문서 업데이트 | 낮음 | - | ✅ |
| 5 | 동시 기믹 우선순위 로직 | 중간 | 중간 | 보류 |
| 6 | 러버밴딩 시스템 | 높음 | 높음 | 장기 |

---

### 추가 Action Items

- [ ] **문서 수정**: `docs/GameGuide/game-type/horse/HORSE_GIMMICK_ANALYSIS.md` 실제 설정값으로 업데이트
- [ ] **기믹 간격 로직 추가**: progressTrigger 생성 시 이전 기믹과 최소 0.10 간격 보장
- [ ] **연속 방지 강화**: lastTwoCategories 배열로 최근 2개 체크

---

**회의 종료**: 2026-02-03 14:30
**추가 검토 완료**: 2026-02-03 15:00
**작성자**: Claude (AI 팀 회의 시뮬레이터)
