# LAMDiceBot 팀 회의록 (Single)

**일시**: 2026-02-26 15:00
**주제**: 경마 새 기믹 추가 — 동기화 & 공정성 원칙 하에 신규 인터랙션 발굴
**참석자 (관점)**:
- 기획팀: 기획 팀장 (A1), 기획 사원 (A2)
- 개발팀: 개발 팀장 (B1), 개발 사원 (B2)
- 디자인팀: UI/UX 디자이너 (C), 사운드 디자이너 (D)
- 품질팀: QA 엔지니어 (E)
**회의 방식**: 1인 순차 분석 (경량 버전)
**게임 대상**: 경마
**절대 원칙**: 동기화 (모든 클라이언트 동일 결과), 공정성 (서버 난수, 플레이어 간 동등 조건)
**참고 문서**: 2026-02-03-1400-horse-balance.md, 2026-02-06-1830-realtime-interaction.md

---

## 1. 현황 요약

**현재 구현 상태**:
- 서버 시뮬레이션 → 클라이언트 재생 방식 (공정성 완전 보장)
- 기믹 시스템: sprint / stop / slow / reverse / wobble / obstacle / item_boost / item_trap (10개 이상)
- 날씨 시스템: 진행률에 따라 동적 변화, 탈것별 보정값 (구현 완료)
- 슬로우모션: Leader (1등 15m 전) + Loser (꼴등 직전 10m 전)
- 배팅 안 된 말 정지, 재보기 3회, 인게임 랭킹 — 최근 구현 완료

**미구현 상태의 설계 채택 항목** (2026-02-06 회의):
- Fair Interaction Pool (방해 3회/부스트 1회/방어 1회 동등 지급)
- 하늘의 심판 (날씨 투표)
- 응원 파도 (결과 무영향)
- Sabotage Touch

---

## 2. 관점별 분석 결과

### 기획팀

#### 2-1. 기획 팀장 (A1)

**전략적 제안**:
1. **날씨 투표 (하늘의 심판)** — 기설계 채택 항목, 즉시 착수 가능. 경주 시작 전 30초 동안 날씨 투표 → 과반수로 결정. 결과는 서버 계산이므로 공정성 문제 없음. 참여도 큰 폭 상승 예상.
2. **배팅 시스템** — 탈것 선택 외에 가상 포인트 배팅 추가. 관전자도 참여 가능. 단, DB 스키마 변경 필요 → 별도 기획 필요.
3. **시즌 랭킹 & 미션** — 주간/월간 리셋 누적 점수로 재방문 유도. 기존 DB 랭킹 구조 활용 가능하나 범위가 큼.

**우선순위**: 날씨 투표 > 배팅 시스템 > 시즌 랭킹

#### 2-2. 기획 사원 (A2)

**사용자 경험 제안**:
1. **경주 중 응원/방해 (Fair Interaction Pool)** — 모든 플레이어에게 동일 자원 지급 (방해 3회/부스트 1회/방어 1회). 경주 중 손가락이 바빠지는 체험 자체가 재미. 공정성: 동등 자원 지급이므로 OK.
2. **연승 저주/축복 기믹** — 2연속 우승 말은 다음 경주에서 기믹 확률 불리하게. 단 공시 필수. 공정성 논란 가능성 있어 설계 필요.
3. **경주 전 말 컨디션 공개** — 최상/좋음/보통/저조 플레이버 텍스트. 실제 결과와 무관 (순수 분위기용). 분석하는 재미 제공.

---

### 개발팀

#### 2-3. 개발 팀장 (B1)

**아키텍처 관점 제안**:
1. **인터랙션 시스템 아키텍처 결정 선행** — Fair Interaction Pool 도입 시 현재 "서버 계산 → 클라이언트 재생" 구조에 클라이언트 입력이 끼어들 수 없음. 두 가지 방식 중 선택 필요:
   - A. 이벤트 적용 후 재시뮬레이션: 완전 공정, 구현 복잡
   - B. 이벤트 큐 사전 삽입: 동기화 쉬움, 설계 어려움
2. **config/horse/race.json 확장** — 기존 기믹 구조(type/speedMultiplier/duration/progressTrigger)에 신규 필드 추가로 새 기믹 대응. 코드 변경 최소화.
3. **인터랙션 전용 Rate Limit** — 현재 50req/10sec 전체 공유. 경주 중 빠른 클릭이 걸릴 수 있음. 인터랙션 전용 쿨다운 로직 필요.

#### 2-4. 개발 사원 (B2)

**구현 관점 제안**:
1. **슬립스트림 기믹** — 뒤에서 달리는 말이 앞 말과 근접 시 속도 보정 +10~15%. 서버 계산에서 상대적 위치 체크 후 speedMultiplier 보너스. 공정성 OK (서버 계산), 동기화 OK (기믹 데이터에 포함). 영향 파일: `socket/horse.js` + `config/horse/race.json`.
2. **날씨 투표 구체 구현** — `weather_vote` 소켓 이벤트 추가 → 서버 집계 → `horseRaceCountdown`에 확정 날씨 포함. 현재 날씨 시스템 재활용. 영향 파일: `socket/horse.js` + `horse-race-multiplayer.html`.
3. **말 컨디션 플레이버** — 서버에서 `condition: '최상'|'좋음'|'보통'|'저조'` 랜덤 생성 → `horseRaceCountdown`에 포함. 결과 계산에 미사용. 동기화 보장 (서버 일괄 생성).

---

### 디자인팀

#### 2-5. UI/UX 디자이너 (C)

**UX 제안**:
1. **기믹 발동 시각 피드백** — 기믹 발동 시 해당 말 위에 아이콘 + 텍스트 팝업 (예: ⚡ 스프린트!, ❌ 장애물!). 이미 기믹 데이터가 클라이언트에 전달되므로 타이밍 맞춰 표시만 추가. 클라이언트 전용 수정.
2. **날씨 투표 UI** — 투표 비율 실시간 바 차트 표시. 확정 순간 선택된 날씨 아이콘이 화면 가득 나타나는 연출.
3. **배팅 UI 통합** — 탈것 선택 화면에 토큰 슬라이더 추가. 심플한 UX.

#### 2-6. 사운드 디자이너 (D)

**사운드 제안**:
1. **기믹별 전용 효과음 강화** — 역주행: "whoa" 충격음, 스프린트: 엔진 흥분음, 장애물: "쿵" 사운드. 기믹 체험 극대화.
2. **날씨 투표 확정 연출음** — 드럼롤 → 확정 효과음. 날씨별 앰비언트 (비: 빗소리 루프, 태풍: 강풍음).
3. **응원 클릭 피드백 사운드** — 클릭 즉각 피드백 + 목표 말 효과음. 인터랙션 체감 강화.

---

### 품질팀

#### 2-7. QA 엔지니어 (E)

**테스트 방법론 제안**:
1. **동기화 검증** — 브라우저 탭 3-5개를 같은 방에 접속 → 경주 시작 → 말 위치/기믹 발동 타이밍/최종 순위가 모든 탭에서 100% 동일한지 육안 확인. 신규 기믹 추가 시 필수 체크.
2. **공정성 검증** — Fair Interaction Pool 같은 "플레이어 입력이 결과에 영향"을 주는 기능 추가 시: 동일 클릭 시나리오 1000회 실행 → 결과 분포 확인. `socket/horse.js`의 `generateRaceData()` 직접 테스트 로직 삽입.
3. **인터랙션 스트레스 테스트** — 응원/방해 버튼 1초 10회 연타 → Rate Limit 정상 작동 + 클라이언트 freezing 없음 + 결과 무결성 확인.

---

## 3. 테스트 전략 (QA 주도)

| 기능 | 테스트 방법 | 검증 기준 |
|------|-------------|-----------|
| 날씨 투표 | 탭 3개에서 각각 다른 날씨 투표 | 모든 클라이언트 동일 날씨 수신 |
| 말 컨디션 플레이버 | 동일 방 재시작 → 컨디션 표시 확인 | 모든 탭 동일 컨디션 표시 |
| 기믹 시각 피드백 | 기믹 발동 구간에서 팝업 표시 확인 | 타이밍 일치 (±100ms) |
| 슬립스트림 기믹 | 말 근접 시나리오 로그 분석 | 뒤 말에만 발동 확인 |
| Fair Interaction Pool | 방해 클릭 후 모든 탭 결과 확인 | 100% 동일 결과 브로드캐스트 |
| 인터랙션 Rate Limit | 1초 10회 연타 시나리오 | Rate Limit 정상 작동 + 무결성 |

---

## 4. 합의 도출

| 우선순위 | 기능 | 판정 | 주요 지지 관점 | 근거 |
|---------|------|------|---------------|------|
| 1 | 날씨 투표 (하늘의 심판) | ✅ 채택 | A1, B2, C, D | 기설계 채택 항목, 공정성 문제 없음, 구현 비용 낮음 |
| 2 | 말 컨디션 플레이버 텍스트 | ✅ 채택 | A2, B2 | 결과 완전 무관 (공정성 100% 보장), 구현 최소 |
| 3 | 기믹 발동 시각 피드백 강화 | ✅ 채택 | C, D, A2 | 클라이언트만 수정, 공정성 무관, UX 즉시 개선 |
| 4 | 슬립스트림 기믹 | ✅ 채택 | B2 | 기존 기믹 구조 확장, 공정성 OK (서버 계산), 구현 비용 적당 |
| 5 | Fair Interaction Pool | ✅ 채택 (설계 먼저) | A2, B1, E | 기설계 채택 항목이나 동기화 아키텍처 결정 선행 필요 |
| 6 | 배팅 시스템 | ⏸ 보류 | A1, C | DB 스키마 변경, 가상 포인트 관리 복잡 — 별도 설계 필요 |
| 7 | 연승 저주/축복 | ⏸ 보류 | A2 | "시작 조건 불균형" 공정성 논란 가능 — 공시 방식 설계 필요 |
| 8 | 시즌 랭킹 & 미션 | ⏸ 보류 | A1 | DB 변경 범위 큼 — 다음 기획 사이클 |

### 관점 간 충돌 사항

- **B1 vs A2**: Fair Interaction Pool 구현 시점 — A2는 즉시 원하나 B1은 재시뮬레이션 vs 사전 슬롯 아키텍처 결정 먼저 요구 → 아키텍처 impl 문서 먼저 작성 후 구현
- **A2 vs E**: 연승 저주/축복 — A2는 재미있는 기믹, E는 "시작 조건 불균형" 자체가 공정성 논란 → 보류, 공시 방식 포함 별도 설계

---

## 5. 다음 단계 (Action Items)

> 구현 상세: [`2026-02-26-1500-horse-new-gimmick-impl.md`](../impl/2026-02-26-1500-horse-new-gimmick-impl.md)

- [ ] 날씨 투표 (하늘의 심판) 구현 — `socket/horse.js` + `horse-race-multiplayer.html`
- [ ] 말 컨디션 플레이버 텍스트 — `socket/horse.js` + `horseRaceCountdown` 이벤트 확장
- [ ] 기믹 발동 시각 피드백 팝업 — `horse-race-multiplayer.html` 클라이언트 전용
- [ ] 슬립스트림 기믹 타입 추가 — `config/horse/race.json` + `socket/horse.js`
- [ ] Fair Interaction Pool 아키텍처 impl 문서 별도 작성 (구현 전 설계 확정)
