# LAMDiceBot 팀 회의록

**일시**: 2026-02-18
**주제**: 경마게임 배팅 안 된 말 처리 (못 달리게)
**참석자**: 기획자, 개발자, QA/UX
**회의 방식**: 3인 멀티에이전트 독립 분석 → 교차 검토 → 합의 도출

---

## 1. 현황 요약

- 경마게임: 4~6마리 말 중 사용자가 1마리 선택(배팅), 꼴등/1등 모드로 당첨자 결정
- 현재: 배팅 안 된 말도 정상적으로 달림 → 의미 없는 경쟁
- `canSelectDuplicate = true`: 여러 명이 같은 말 선택 가능 → 배팅 안 된 말 존재 가능
- 기믹 시스템: 서버가 생성한 `{progressTrigger, type, duration, speedMultiplier}` 데이터를 클라이언트가 그대로 소비

## 2. 독립 분석 결과

### 2-1. 기획자 (A)

| 제안 | 전략적 의의 | 사용자 가치 | 우선순위 |
|------|-----------|-----------|---------|
| 배팅 안 된 말 출발선 정지 | 배팅의 의미 강화, 선택의 무게감 | 경쟁 집중도 향상 | 상 |
| 말 수를 사람 수로 맞춤 | 모든 말에 의미 부여 | 선택의 재미 감소 우려 | 하 |
| 멈춘 말 시각적 표시 (회색 등) | 직관적 UX | 경기 상황 이해 용이 | 중 |

- **핵심 의견**: 말 수는 그대로 유지하되, 배팅 안 된 말만 못 달리게 하는 게 선택의 재미와 경쟁 집중도 둘 다 잡을 수 있음
- 꼴등 모드에서 "진짜 꼴등"은 배팅된 말 중 꼴등이어야 게임성 유지

### 2-2. 개발자 (B)

| 제안 | 구현 방법 | 영향 파일 | 난이도 |
|------|----------|----------|--------|
| 기믹 시스템 활용 (speedMultiplier: 0) | 서버에서 배팅 안 된 말 기믹 교체 | socket/horse.js | 하 |
| 서버 시뮬레이션 종료 조건 수정 | 배팅된 말만 완주 체크 | socket/horse.js | 하 |
| 서버 Loser 슬로우모션 필터링 | 배팅된 말만 대상 | socket/horse.js | 하 |
| 꼴등 모드 당첨자 계산 수정 | 배팅된 말 중 꼴등 | socket/horse.js | 하 |
| 클라이언트 랜덤 컷어웨이 필터 | 배팅된 말만 후보 | js/horse-race.js | 하 |

- **핵심 의견**: 기존 기믹 시스템을 그대로 활용하면 클라이언트 수정 최소화. `speedMultiplier: 0`이면 서버/클라이언트 양쪽 모두 자연스럽게 멈춤
- 클라이언트 카메라/슬로우모션/종료 조건은 대부분 이미 배팅 필터링 되어있음

### 2-3. QA/UX (C)

| 제안 | 테스트 방법 | UX 개선점 | 리스크 |
|------|-----------|----------|--------|
| 무한루프 방지 검증 | 멈춘 말이 시뮬레이션 종료를 막는지 확인 | - | 상 |
| 카메라 전체 검증 | 모든 카메라 모드에서 멈춘 말 추적 여부 | 멈춘 말 카메라 방지 | 상 |
| 꼴등 모드 당첨자 검증 | 멈춘 말이 꼴등 독점하는지 | 게임성 유지 | 상 |
| 다시보기 재현 검증 | 기록된 gimmicks에 unbetted_stop 포함 여부 | 동일 재현 | 중 |

- **핵심 의견**: 단순히 멈추는 것 외에 파급 효과(무한루프, 카메라, 당첨자)가 중요. 서버 시뮬레이션 종료 조건과 꼴등 모드 당첨자 계산이 핵심 리스크

## 3. 교차 검토 결과

### 3-1. 기획자 검토
- B의 기믹 활용 방식 **긍정**: 기존 시스템 재활용으로 일관성 유지
- C의 무한루프/당첨자 리스크 **동의**: 게임성 직결 문제

### 3-2. 개발자 검토
- A의 "말 수 유지" **긍정**: 구현 범위 최소화
- C의 카메라 전체 검증 **동의**: 확인 결과 랜덤 컷어웨이에 필터 누락 발견

### 3-3. QA/UX 검토
- A의 시각 표시(회색) **보류**: 현재 기믹에 시각 이펙트 매핑 안 됨 = 자연스럽게 이펙트 없음. 추후 별도 작업
- B의 구현 방식 **긍정**: 서버 단일 파일 수정으로 리스크 최소화

## 4. 합의 도출

| 우선순위 | 기능 | 판정 | 기획 | 개발 | QA/UX | 근거 |
|---------|------|------|------|------|-------|------|
| 1 | 배팅 안 된 말 출발선 정지 | **채택** | ✅ | ✅ | ✅ | 핵심 요청, 기믹 시스템 활용 |
| 2 | 서버 시뮬레이션 종료 조건 수정 | **채택** | ✅ | ✅ | ✅ | 무한루프 방지 필수 |
| 3 | 서버 Loser 슬로우모션 필터 | **채택** | ✅ | ✅ | ✅ | 멈춘 말 슬로우모션 방지 |
| 4 | 꼴등 모드 당첨자 배팅 필터 | **채택** | ✅ | ✅ | ✅ | 게임성 유지 필수 |
| 5 | 클라이언트 컷어웨이 필터 | **채택** | ✅ | ✅ | ✅ | 카메라가 멈춘 말 추적 방지 |
| 6 | 말 수를 사람 수로 맞춤 | **기각** | ❌ | - | - | 선택의 재미 감소 |
| 7 | 멈춘 말 시각 표시 (회색) | **보류** | ✅ | - | ✅ | 추후 별도 작업 |

### 의견 충돌 사항

없음. 전원 합의.

## 5. 다음 단계 (Action Items)

> 구현 상세: [`2026-02-18-horse-unbetted-stop-impl.md`](../impl/2026-02-18-horse-unbetted-stop-impl.md)

- [x] 배팅 안 된 말 즉시 정지 기믹 교체
- [x] 서버 시뮬레이션 종료 조건 수정
- [x] 서버 Loser 슬로우모션 배팅 필터
- [x] 꼴등 모드 당첨자 계산 수정
- [x] 클라이언트 랜덤 컷어웨이 배팅 필터
- [ ] 실서버 테스트 (커밋 후)
