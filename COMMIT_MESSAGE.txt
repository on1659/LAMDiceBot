feat: 게임 룰 선택 라디오 버튼 기능 추가

## 주요 변경사항

### 1. 게임 룰 선택 UI 추가
- 방 생성 후 게임 섹션에서 방장만 게임 룰을 선택할 수 있도록 라디오 버튼 추가
- 하이: 낮은 사람이 걸림
- 로우: 높은 사람이 걸림
- 니어: N에 가까운 사람 걸리기 (숫자 입력 필드 포함)
- 기타: 직접 룰 적기 (텍스트 영역 포함)

### 2. 저장 버튼 유효성 검사
- 니어 선택 시 숫자를 입력하지 않으면 저장 버튼 비활성화
- 기타 선택 시 텍스트를 입력하지 않으면 저장 버튼 비활성화
- 입력 시 실시간으로 저장 버튼 상태 업데이트

### 3. 권한 관리
- 방장만 게임 룰 선택 라디오 버튼 표시
- 참여자는 선택된 룰만 읽기 전용으로 표시
- 게임 시작 전에만 룰 수정 가능

## 기술적 변경사항

### 서버 측 (server.js)
- 방 생성 시 gameRules 파라미터 제거 (방 생성 후 설정하도록 변경)
- 방 생성 시 gameRules는 빈 문자열로 시작
- roomCreated 이벤트에 gameRules 포함하여 전송

### 클라이언트 측 (dice-game-multiplayer.html)
- **방 생성 섹션**
  * 게임 룰 선택 UI 제거 (방 생성 후 설정하도록 변경)

- **게임 섹션**
  * 게임 룰 선택 라디오 버튼 섹션 추가 (방장만 표시)
  * 라디오 버튼 선택에 따라 룰 텍스트 자동 생성
  * 니어 선택 시 숫자 입력 필드 표시/숨김
  * 기타 선택 시 텍스트 영역 표시/숨김
  * 저장 버튼 활성화/비활성화 함수 추가 (`updateGameRulesSaveButtonState`)
  * 룰 텍스트 파싱 함수 추가 (`parseGameRulesToRadio`)

- **이벤트 리스너**
  * 라디오 버튼 변경 시 룰 텍스트 업데이트 및 저장 버튼 상태 확인
  * 니어 숫자 입력 시 실시간 업데이트
  * 기타 룰 입력 시 실시간 업데이트

- **유효성 검사**
  * 저장 버튼 클릭 시 니어/기타 입력 여부 재확인
  * 입력이 없으면 알림 표시 및 포커스 이동

## UX 개선
- 방 생성 시 복잡한 설정 제거로 사용자 경험 개선
- 방 생성 후 필요에 따라 룰 설정 가능
- 니어/기타 선택 시 필수 입력 안내 (저장 버튼 비활성화)

## 수정된 파일
- server.js
- dice-game-multiplayer.html
- COMMIT_MESSAGE.txt

---

fix: 방 유지 조건 개선 및 새로고침 시 데이터 복원

## 주요 변경사항

### 1. 방 유지 조건 개선
- 모든 사용자가 나가도 방은 지정된 시간(1/3/6시간)까지 유지됨
- 모든 사용자가 나가면 방장 정보 초기화
- 빈 방에 첫 번째 입장자를 자동으로 방장으로 설정

### 2. 새로고침 시 데이터 복원 개선
- 브라우저 캐시 방지 헤더 추가 (HTML 메타 태그 및 서버 헤더)
- 진행 상황 복원 (rolledUsersInGame 복원 및 진행 상황 업데이트)
- 채팅 기록 복원 (재연결 시 채팅 기록 전송 및 표시)

## 기술적 변경사항

### 서버 측 (server.js)
- `leaveRoom` 함수 수정: 모든 사용자가 나가도 방 삭제하지 않고 유지
- `disconnect` 이벤트 수정: 모든 사용자가 나가도 방 삭제하지 않고 유지
- 방장 정보 초기화: `room.hostId = null`, `room.hostName = null`
- 방 입장 로직 개선: 빈 방에 첫 입장자를 자동으로 방장으로 설정
- 재연결 시 채팅 기록 전송 추가
- 캐시 방지 헤더 추가 (정적 파일 및 메인 라우트)
- `userName` const 재할당 에러 수정 (`inputUserName`으로 변경)

### 클라이언트 측 (dice-game-multiplayer.html)
- 캐시 방지 메타 태그 추가 (`Cache-Control`, `Pragma`, `Expires`)
- 진행 상황 복원 로직 추가 (`rolledUsersInGame` 복원 및 `updateProgress` 호출)
- 채팅 기록 복원 로직 개선 (항상 초기화하고 표시)

## 버그 수정
- 새로고침 시 진행 상황이 0/0으로 표시되던 문제 해결
- 새로고침 시 채팅 기록이 사라지던 문제 해결
- 새로고침 시 주사위를 굴린 사람이 반영되지 않던 문제 해결
- `userName` const 재할당 에러 수정

## 수정된 파일
- server.js
- dice-game-multiplayer.html
- ladder-game-multiplayer.html
- CHANGELOG.md
- COMMIT_MESSAGE.txt

---

fix: 하이/로우 게임 애니메이션 조건 수정 및 활성화 조건 완화

## 주요 변경사항

### 1. 하이/로우 게임 애니메이션 조건 수정
- 하이 게임: 지금까지 결과 중 제일 작은 값이 나왔을 때 애니메이션
- 로우 게임: 지금까지 결과 중 제일 큰 값이 나왔을 때 애니메이션
- 기존에 반대로 되어 있던 조건을 올바르게 수정

### 2. 애니메이션 활성화 조건 완화
- 참여자 조건: 5명 이상 → 4명 이상
- 굴림 순서: 6번째 이후 → 4번째 이후

## 기술적 변경사항

### 서버 측 (server.js)
- `isHighGameAnimation` 조건 수정
  * 최고값 비교 → 최저값 비교로 변경 (`result > maxRoll` → `result < minRoll`)
  * 참여자 조건: `>= 5` → `>= 4`
  * 굴림 순서: `rolledUsers.length >= 5` → `>= 3`

- `isLowGameAnimation` 조건 수정
  * 최저값 비교 → 최고값 비교로 변경 (`result < minRoll` → `result > maxRoll`)
  * 참여자 조건: `>= 5` → `>= 4`
  * 굴림 순서: `rolledUsers.length >= 5` → `>= 3`

- `isNearGameAnimation` 조건 수정
  * 참여자 조건: `>= 5` → `>= 4`
  * 굴림 순서: `rolledUsers.length >= 5` → `>= 3`

## 버그 수정
- 하이 게임과 로우 게임의 애니메이션 조건이 반대로 되어 있던 문제 해결

## 수정된 파일
- server.js
- CHANGELOG.md
- COMMIT_MESSAGE.txt

---

fix: IP 중복 체크 및 MAC 주소 체크 로직 강화

  ## 주요 변경사항

  ### 1. IP 추출 로직 개선
  - IPv6-mapped IPv4 주소 처리 추가 (`::ffff:` 제거)
  - 프록시/로드밸런서 환경에서 IP 추출 정확도 향상
  - 다양한 소켓 속성에서 IP 주소 추출 시도
  - 로컬 테스트 환경 IPv6 주소를 IPv4로 변환

  ### 2. 방 생성 시 IP 체크 추가
  - 기존: 방 입장 시에만 IP 체크
  - 변경: 방 생성 시에도 IP/deviceId 중복 체크 수행
  - 다른 방에 이미 입장한 경우 방 생성 차단
  - 모든 소켓을 확인하여 같은 IP/deviceId를 가진 사용자 검색

  ### 3. 방 입장 시 IP 체크 개선
  - 기존: 같은 방 내에서만 IP 체크
  - 변경: 모든 방에서 IP/deviceId 중복 체크
  - deviceId가 있으면 IP와 deviceId 모두 확인
  - deviceId가 없으면 IP만 확인

  ### 4. getCurrentRoom 핸들러에도 IP 체크 추가
  - 재연결 시에도 IP/deviceId 중복 체크 수행
  - 같은 이름은 재연결로 간주하여 허용
  - 다른 이름으로 중복 접속 시 차단

  ### 5. 디버깅 로그 추가
  - IP 체크가 작동할 때 콘솔에 상세 로그 출력
  - 소켓 연결 시 IP 주소와 socket.id 로깅

  ## 기술적 변경사항

  ### 서버 측 (server.js)
  - `getClientIP()` 함수 개선
    * IPv6-mapped IPv4 주소 처리
    * 프록시 헤더(`x-forwarded-for`) 우선 처리
    * 다양한 소켓 속성에서 IP 추출 시도
    * 로컬 테스트 환경 IPv6 주소 변환

  - `createRoom` 핸들러 수정
    * IP 차단 옵션이 활성화된 경우 방 생성 전 IP/deviceId 체크
    * `io.fetchSockets()`로 모든 소켓 확인
    * 같은 IP/deviceId를 가진 사용자가 다른 방에 있으면 방 생성 차단

  - `joinRoom` 핸들러 수정
    * 모든 방에서 IP/deviceId 중복 체크 (같은 방뿐만 아니라)
    * `io.fetchSockets()`로 모든 소켓 확인
    * 같은 방/다른 방 구분하여 에러 메시지 제공

  - `getCurrentRoom` 핸들러 수정
    * IP 차단 옵션이 활성화된 경우 IP/deviceId 체크 추가
    * 같은 이름은 재연결로 간주하여 허용
    * 다른 이름으로 중복 접속 시 차단

  - 소켓 연결 시 IP 주소 로깅 추가

  ## 버그 수정
  - IP 추출이 제대로 되지 않던 문제 해결
  - 방 생성 시 IP 체크가 작동하지 않던 문제 해결
  - 방 입장 시 다른 방에서의 중복 체크가 작동하지 않던 문제 해결

## 수정된 파일
- server.js
- CHANGELOG.md
- COMMIT_MESSAGE.txt

---

feat: 대기실 통계 기능 추가 및 게임 자동 종료 개선

## 주요 변경사항

### 1. 대기실 통계 기능 추가
- 대기실 우상단에 오늘의 주사위 굴린 횟수와 평균값 표시
- 모든 방에서 진행된 공식전 기록을 집계하여 표시
- 공식전만 포함 (연습 제외)
- 방이 삭제되어도 기록 유지 (전역 저장소 사용)
- 주사위 범위가 100이 아닐 때 1~100 범위로 정규화하여 평균 계산

### 2. 게임 자동 종료 기능
- 모든 참여자가 주사위를 굴리면 자동으로 게임 종료
- 게임 종료 시 결과 팝업 제거 (게임 기록에서만 확인 가능)

## 기술적 변경사항

### 서버 측 (server.js)
- **오늘의 주사위 통계 계산 함수 추가**
  * `getTodayDiceStats()` 함수 추가
  * 전역 저장소(`todayDiceRecords`)와 현재 존재하는 방의 기록을 모두 집계
  * 공식전(`isGameActive === true`) 기록만 필터링
  * 주사위 범위 정규화 함수 `normalizeTo100()` 추가

- **전역 저장소 추가**
  * `todayDiceRecords` 배열 추가 (방이 삭제되어도 기록 유지)
  * 방 삭제 시 오늘 날짜의 공식전 기록을 전역 저장소에 저장
  * 중복 저장 방지 로직 추가

- **주사위 기록에 날짜 및 게임 상태 추가**
  * `date` 필드 추가 (YYYY-MM-DD 형식)
  * `isGameActive` 필드 추가 (게임 진행 중일 때 굴린 주사위인지 표시)

- **게임 시작 시 history 초기화 제거**
  * 게임 시작 시 `gameState.history = []` 제거
  * 누적 기록 유지로 통계 계산 가능

- **자동 게임 종료 기능**
  * 모든 참여자가 주사위를 굴렸을 때 자동으로 게임 종료
  * `allPlayersRolled` 이벤트 발생 시 게임 종료 처리

- **통계 조회 이벤트 추가**
  * `getTodayDiceStats` 이벤트 핸들러 추가
  * 주사위를 굴릴 때마다 통계 업데이트

### 클라이언트 측 (dice-game-multiplayer.html)
- **대기실 통계 표시 영역 추가**
  * 대기실 우상단에 통계 표시 영역 추가
  * 통계 요청 및 표시 함수 추가
  * 방 목록 새로고침 시 통계도 함께 업데이트

- **게임 시작 시 history 초기화 제거**
  * 게임 시작 시 `historyData = []` 제거
  * `renderHistory` 함수에서 게임 진행 중일 때 현재 게임의 기록만 필터링해서 표시

- **게임 종료 시 팝업 제거**
  * 게임 종료 시 결과를 보여주는 `alert` 팝업 제거
  * 결과는 게임 기록에서만 확인 가능

## 버그 수정
- 주사위를 1회 굴리면 카운트가 2씩 늘어나던 문제 해결 (중복 저장 제거)
- 방이 삭제되면 통계에서 기록이 사라지던 문제 해결 (전역 저장소 추가)

## 수정된 파일
- server.js
- dice-game-multiplayer.html
- CHANGELOG.md
- COMMIT_MESSAGE.txt
